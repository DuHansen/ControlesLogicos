let express=require("express"),bodyParser=require("body-parser"),session=require("express-session"),csurf=require("csurf"),helmet=require("helmet"),db=require("./database"),app=express();app.use(bodyParser.urlencoded({extended:!1})),app.use(session({secret:"secret",resave:!1,saveUninitialized:!0})),app.use(csurf()),app.use(helmet()),app.set("view engine","ejs"),app.get("/",(r,t)=>{db.all("SELECT * FROM tasks",[],(e,s)=>{if(e)return t.status(500).send("Error fetching tasks");t.render("index",{tasks:s,csrfToken:r.csrfToken()})})}),app.post("/add",(e,s)=>{e=e.body.description;db.run("INSERT INTO tasks (description) VALUES (?)",[e],e=>{if(e)return s.status(500).send("Error adding task");s.redirect("/")})}),app.listen(3e3,e=>{e?console.error("Error starting the server:",e):console.log("Server is running on http://localhost:3000")});